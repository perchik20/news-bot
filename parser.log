2025-05-26 01:34:11 ERROR Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2025-05-26 01:34:11 WARNING Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8184897566)
2025-05-26 01:34:23 INFO Connection established (tryings = 1, bot id = 8184897566)
2025-05-26 01:38:11 INFO ====== WebDriver manager ======
2025-05-26 01:38:11 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 01:38:11 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 01:38:11 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 01:38:13 INFO ====== WebDriver manager ======
2025-05-26 01:38:13 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 01:38:13 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 01:38:13 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 01:38:17 INFO ====== WebDriver manager ======
2025-05-26 01:38:17 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 01:38:18 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 01:38:18 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 01:39:08 WARNING Received SIGINT signal
2025-05-26 01:39:08 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:39:08 INFO Polling stopped
2025-05-26 01:39:08 ERROR Ошибка внутри блока fetch_news:
Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 461, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/parser.py", line 51, in fetch_news
    await asyncio.to_thread(driver.get, main_url)
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/webdriver.py", line 473, in get
    self.execute(Command.GET, {"url": url})
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/webdriver.py", line 446, in execute
    response = self.command_executor.execute(driver_command, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/request.py", line 78, in request
    return self.request_encode_body(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/request.py", line 170, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/poolmanager.py", line 376, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 798, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/util/retry.py", line 550, in increment
    raise six.reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/packages/six.py", line 769, in reraise
    raise value.with_traceback(tb)
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 461, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-05-26 01:39:08 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x108b08ec0>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4c8e4a5e158687ed62f9d0f37ad87b9e
2025-05-26 01:39:08 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x108b09190>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4c8e4a5e158687ed62f9d0f37ad87b9e
2025-05-26 01:39:08 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x108b09460>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4c8e4a5e158687ed62f9d0f37ad87b9e
2025-05-26 01:39:10 INFO Start polling
2025-05-26 01:39:10 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:39:36 WARNING Received SIGINT signal
2025-05-26 01:39:36 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:39:36 INFO Polling stopped
2025-05-26 01:39:39 INFO Start polling
2025-05-26 01:39:39 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:39:39 INFO Update id=470612395 is handled. Duration 260 ms by bot id=8184897566
2025-05-26 01:39:39 INFO Update id=470612396 is handled. Duration 303 ms by bot id=8184897566
2025-05-26 01:40:31 WARNING Received SIGINT signal
2025-05-26 01:40:31 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:40:31 INFO Polling stopped
2025-05-26 01:40:32 INFO Start polling
2025-05-26 01:40:33 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:40:35 INFO Update id=470612397 is handled. Duration 229 ms by bot id=8184897566
2025-05-26 01:40:43 WARNING Received SIGINT signal
2025-05-26 01:40:43 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 01:40:43 INFO Polling stopped
2025-05-26 02:05:52 INFO Start polling
2025-05-26 02:05:52 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:06:00 INFO Update id=470612398 is handled. Duration 258 ms by bot id=8184897566
2025-05-26 02:06:01 INFO Update id=470612399 is handled. Duration 113 ms by bot id=8184897566
2025-05-26 02:06:05 INFO Update id=470612400 is handled. Duration 93 ms by bot id=8184897566
2025-05-26 02:06:08 INFO Update id=470612401 is handled. Duration 109 ms by bot id=8184897566
2025-05-26 02:06:09 INFO ====== WebDriver manager ======
2025-05-26 02:06:10 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:06:10 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:06:10 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:06:11 INFO ====== WebDriver manager ======
2025-05-26 02:06:11 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:06:11 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:06:12 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:06:12 INFO ====== WebDriver manager ======
2025-05-26 02:06:12 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:06:13 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:06:13 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:06:13 INFO Update id=470612402 is handled. Duration 3931 ms by bot id=8184897566
2025-05-26 02:06:23 INFO Update id=470612403 is handled. Duration 561 ms by bot id=8184897566
2025-05-26 02:06:35 INFO Update id=470612404 is handled. Duration 107 ms by bot id=8184897566
2025-05-26 02:06:36 INFO Update id=470612405 is handled. Duration 80 ms by bot id=8184897566
2025-05-26 02:07:20 WARNING Received SIGINT signal
2025-05-26 02:07:20 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:07:20 INFO Polling stopped
2025-05-26 02:07:31 INFO Start polling
2025-05-26 02:07:32 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:07:32 INFO Update id=470612406 is handled. Duration 254 ms by bot id=8184897566
2025-05-26 02:08:26 WARNING Received SIGINT signal
2025-05-26 02:08:26 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:08:26 INFO Polling stopped
2025-05-26 02:08:36 INFO Start polling
2025-05-26 02:08:36 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:08:36 INFO Update id=470612407 is handled. Duration 195 ms by bot id=8184897566
2025-05-26 02:08:41 INFO Update id=470612408 is handled. Duration 100 ms by bot id=8184897566
2025-05-26 02:08:44 INFO Update id=470612409 is handled. Duration 80 ms by bot id=8184897566
2025-05-26 02:08:47 INFO Update id=470612410 is handled. Duration 92 ms by bot id=8184897566
2025-05-26 02:08:50 INFO Update id=470612411 is handled. Duration 76 ms by bot id=8184897566
2025-05-26 02:09:01 INFO ====== WebDriver manager ======
2025-05-26 02:09:02 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:02 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:02 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:09:03 INFO ====== WebDriver manager ======
2025-05-26 02:09:03 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:03 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:03 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:09:04 INFO ====== WebDriver manager ======
2025-05-26 02:09:04 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:04 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:04 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:09:05 INFO ====== WebDriver manager ======
2025-05-26 02:09:05 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:05 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:09:05 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:09:06 INFO Update id=470612412 is handled. Duration 4272 ms by bot id=8184897566
2025-05-26 02:09:15 INFO Update id=470612413 is handled. Duration 79 ms by bot id=8184897566
2025-05-26 02:09:18 INFO Update id=470612414 is handled. Duration 380 ms by bot id=8184897566
2025-05-26 02:12:13 WARNING Received SIGINT signal
2025-05-26 02:12:13 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:12:13 INFO Polling stopped
2025-05-26 02:12:16 INFO Start polling
2025-05-26 02:12:16 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:12:25 INFO Update id=470612415 is handled. Duration 193 ms by bot id=8184897566
2025-05-26 02:12:29 INFO Update id=470612416 is handled. Duration 103 ms by bot id=8184897566
2025-05-26 02:12:31 INFO Update id=470612417 is handled. Duration 98 ms by bot id=8184897566
2025-05-26 02:12:40 INFO ====== WebDriver manager ======
2025-05-26 02:12:40 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:41 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:41 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:12:41 INFO ====== WebDriver manager ======
2025-05-26 02:12:42 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:42 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:42 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:12:42 INFO ====== WebDriver manager ======
2025-05-26 02:12:43 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:43 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:43 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:12:44 INFO ====== WebDriver manager ======
2025-05-26 02:12:44 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:44 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:12:44 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:12:45 INFO Update id=470612418 is handled. Duration 4442 ms by bot id=8184897566
2025-05-26 02:12:52 INFO Update id=470612419 is handled. Duration 211 ms by bot id=8184897566
2025-05-26 02:13:56 WARNING Received SIGINT signal
2025-05-26 02:13:56 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:13:56 INFO Polling stopped
2025-05-26 02:13:57 INFO Start polling
2025-05-26 02:13:58 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:14:00 INFO Update id=470612420 is handled. Duration 214 ms by bot id=8184897566
2025-05-26 02:14:01 INFO Update id=470612421 is handled. Duration 96 ms by bot id=8184897566
2025-05-26 02:14:02 INFO Update id=470612422 is handled. Duration 81 ms by bot id=8184897566
2025-05-26 02:14:04 INFO Update id=470612423 is handled. Duration 97 ms by bot id=8184897566
2025-05-26 02:14:10 WARNING Received SIGINT signal
2025-05-26 02:14:10 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:14:10 INFO Polling stopped
2025-05-26 02:21:05 INFO Start polling
2025-05-26 02:21:05 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:21:07 INFO Update id=470612424 is handled. Duration 199 ms by bot id=8184897566
2025-05-26 02:21:28 INFO Update id=470612425 is handled. Duration 174 ms by bot id=8184897566
2025-05-26 02:21:31 INFO Update id=470612426 is handled. Duration 79 ms by bot id=8184897566
2025-05-26 02:21:32 INFO Update id=470612427 is handled. Duration 99 ms by bot id=8184897566
2025-05-26 02:21:35 INFO Update id=470612428 is handled. Duration 84 ms by bot id=8184897566
2025-05-26 02:21:37 INFO ====== WebDriver manager ======
2025-05-26 02:21:37 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:37 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:37 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:21:38 INFO ====== WebDriver manager ======
2025-05-26 02:21:38 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:38 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:38 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:21:39 INFO ====== WebDriver manager ======
2025-05-26 02:21:39 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:39 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:39 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:21:40 INFO ====== WebDriver manager ======
2025-05-26 02:21:40 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:40 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:40 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:21:41 INFO ====== WebDriver manager ======
2025-05-26 02:21:41 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:41 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:21:41 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:21:42 INFO Update id=470612429 is handled. Duration 5394 ms by bot id=8184897566
2025-05-26 02:22:03 ERROR Не найден элемент по XPATH. Возможно, изменился путь или страница не загрузилась полностью.
Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/parser.py", line 53, in fetch_news
    elem = await asyncio.to_thread(wait.until, EC.presence_of_element_located((By.XPATH, TITEL_XPATH)))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
0   chromedriver                        0x0000000102e243e0 cxxbridge1$str$ptr + 2829900
1   chromedriver                        0x0000000102e1c6a8 cxxbridge1$str$ptr + 2797844
2   chromedriver                        0x0000000102959fbc cxxbridge1$string$len + 90140
3   chromedriver                        0x00000001029a11bc cxxbridge1$string$len + 381468
4   chromedriver                        0x00000001029e2044 cxxbridge1$string$len + 647332
5   chromedriver                        0x00000001029953f8 cxxbridge1$string$len + 332888
6   chromedriver                        0x0000000102de8804 cxxbridge1$str$ptr + 2585200
7   chromedriver                        0x0000000102debad4 cxxbridge1$str$ptr + 2598208
8   chromedriver                        0x0000000102dc9dd8 cxxbridge1$str$ptr + 2459716
9   chromedriver                        0x0000000102dec34c cxxbridge1$str$ptr + 2600376
10  chromedriver                        0x0000000102dbb664 cxxbridge1$str$ptr + 2400464
11  chromedriver                        0x0000000102e0c2b0 cxxbridge1$str$ptr + 2731292
12  chromedriver                        0x0000000102e0c43c cxxbridge1$str$ptr + 2731688
13  chromedriver                        0x0000000102e1c2f4 cxxbridge1$str$ptr + 2796896
14  libsystem_pthread.dylib             0x000000019915b2e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x00000001991560fc thread_start + 8

2025-05-26 02:22:03 ERROR Ошибка внутри блока fetch_news:
Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/parser.py", line 59, in fetch_news
    if url and url not in seen_urls:
       ^^^
UnboundLocalError: cannot access local variable 'url' where it is not associated with a value
2025-05-26 02:22:09 INFO ====== WebDriver manager ======
2025-05-26 02:22:09 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:09 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:09 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:22:13 WARNING Received SIGINT signal
2025-05-26 02:22:13 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:22:13 INFO Polling stopped
2025-05-26 02:22:13 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b6ee10>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4b31604646bdb8c6212f1a3abbbca565/element
2025-05-26 02:22:13 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b02570>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4b31604646bdb8c6212f1a3abbbca565/element
2025-05-26 02:22:13 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1033f7a40>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4b31604646bdb8c6212f1a3abbbca565/element
2025-05-26 02:22:13 ERROR Не найден элемент по XPATH. Возможно, изменился путь или страница не загрузилась полностью.
Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1336, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1382, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1091, in _send_output
    self.send(msg)
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py", line 1035, in send
    self.connect()
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x103b888f0>: Failed to establish a new connection: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/parser.py", line 53, in fetch_news
    elem = await asyncio.to_thread(wait.until, EC.presence_of_element_located((By.XPATH, TITEL_XPATH)))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
            ^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/webdriver.py", line 917, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/webdriver.py", line 446, in execute
    response = self.command_executor.execute(driver_command, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/request.py", line 78, in request
    return self.request_encode_body(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/request.py", line 170, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/poolmanager.py", line 376, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 826, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 826, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 826, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 798, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Users/egorprichik/Documents/moya proga/all/venv/lib/python3.12/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56981): Max retries exceeded with url: /session/4b31604646bdb8c6212f1a3abbbca565/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b888f0>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-05-26 02:22:13 ERROR Ошибка внутри блока fetch_news:
Traceback (most recent call last):
  File "/Users/egorprichik/Documents/moya proga/all/parser.py", line 59, in fetch_news
    if url and url not in seen_urls:
       ^^^
UnboundLocalError: cannot access local variable 'url' where it is not associated with a value
2025-05-26 02:22:13 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b88470>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4b31604646bdb8c6212f1a3abbbca565
2025-05-26 02:22:13 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b89250>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4b31604646bdb8c6212f1a3abbbca565
2025-05-26 02:22:13 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b89520>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/4b31604646bdb8c6212f1a3abbbca565
2025-05-26 02:22:13 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1033f6900>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/34cd1dd45dde90ac640c5e04e03ad272/element
2025-05-26 02:22:13 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b89a60>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/34cd1dd45dde90ac640c5e04e03ad272/element
2025-05-26 02:22:13 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x103b89d30>: Failed to establish a new connection: [Errno 61] Connection refused')': /session/34cd1dd45dde90ac640c5e04e03ad272/element
2025-05-26 02:22:24 INFO Start polling
2025-05-26 02:22:25 INFO Run polling for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:22:25 INFO Update id=470612430 is handled. Duration 186 ms by bot id=8184897566
2025-05-26 02:22:28 INFO Update id=470612431 is handled. Duration 294 ms by bot id=8184897566
2025-05-26 02:22:46 INFO Update id=470612432 is handled. Duration 144 ms by bot id=8184897566
2025-05-26 02:22:48 INFO Update id=470612433 is handled. Duration 92 ms by bot id=8184897566
2025-05-26 02:22:49 INFO Update id=470612434 is handled. Duration 96 ms by bot id=8184897566
2025-05-26 02:22:51 INFO Update id=470612435 is handled. Duration 70 ms by bot id=8184897566
2025-05-26 02:22:54 INFO ====== WebDriver manager ======
2025-05-26 02:22:54 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:54 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:54 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:22:55 INFO ====== WebDriver manager ======
2025-05-26 02:22:55 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:55 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:56 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:22:56 INFO ====== WebDriver manager ======
2025-05-26 02:22:56 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:56 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:57 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:22:57 INFO ====== WebDriver manager ======
2025-05-26 02:22:57 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:57 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:58 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:22:58 INFO ====== WebDriver manager ======
2025-05-26 02:22:58 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:58 INFO Get LATEST chromedriver version for google-chrome
2025-05-26 02:22:59 INFO Driver [/Users/egorprichik/.wdm/drivers/chromedriver/mac64/136.0.7103.113/chromedriver-mac-arm64/chromedriver] found in cache
2025-05-26 02:22:59 INFO Update id=470612436 is handled. Duration 5326 ms by bot id=8184897566
2025-05-26 02:23:13 INFO Update id=470612437 is handled. Duration 177 ms by bot id=8184897566
2025-05-26 02:23:25 INFO Update id=470612438 is handled. Duration 340 ms by bot id=8184897566
2025-05-26 02:23:26 INFO Update id=470612439 is handled. Duration 140 ms by bot id=8184897566
2025-05-26 02:23:49 WARNING Received SIGINT signal
2025-05-26 02:23:49 INFO Polling stopped for bot @the_backup_news_bot id=8184897566 - 'the backup bot'
2025-05-26 02:23:49 INFO Polling stopped
